<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>this 豁然开朗！</title>
  <meta property="og:title" content="this 豁然开朗！" />
  <meta name="twitter:title" content="this 豁然开朗！" />
  <meta name="description" content="this 豁然开朗的四种规则

调用点（call-site）


调用点：“找到一个函数是在哪里被调用的”，但不总是那么简单，比如某些特定的编码模式会使 真正的 调用点变得不那么明确。

调用栈（call-stack）

调用栈：使我们到达当前执行位置而被调用的所有方法的堆栈。

我们来展示一下调用栈和调用点：


">
  <meta property="og:description" content="this 豁然开朗的四种规则

调用点（call-site）


调用点：“找到一个函数是在哪里被调用的”，但不总是那么简单，比如某些特定的编码模式会使 真正的 调用点变得不那么明确。

调用栈（call-stack）

调用栈：使我们到达当前执行位置而被调用的所有方法的堆栈。

我们来展示一下调用栈和调用点：


">
  <meta name="twitter:description" content="this 豁然开朗的四种规则

调用点（call-site）


调用点：“找到一个函数是在哪里被调用的”，但不总是那么简单，比如某些特定的编码模式会使 真正的 调用点变得不那么明确。

调用栈（call-stack）

调用栈：使我们到达当前执行位置而被调用的所有方法的堆栈。

我们来展示一下调用栈和调用点：


">
  <meta name="author" content="Gopherzhang"/>
  <link href='https://driverzhang.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://driverzhang.github.io/img/gopher-head.png" />
  <meta name="twitter:image" content="https://driverzhang.github.io/img/gopher-head.png" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://driverzhang.github.io/post/this-%E8%B1%81%E7%84%B6%E5%BC%80%E6%9C%97/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Gopherzhang" />

  <meta name="generator" content="Hugo 0.48" />
  <link rel="canonical" href="https://driverzhang.github.io/post/this-%E8%B1%81%E7%84%B6%E5%BC%80%E6%9C%97/" />
  <link rel="alternate" href="https://driverzhang.github.io/index.xml" type="application/rss+xml" title="Gopherzhang">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://driverzhang.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://driverzhang.github.io/css/highlight.min.css" /><link rel="stylesheet" href="https://driverzhang.github.io/css/codeblock.css" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://driverzhang.github.io/">Gopherzhang</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="tags" href="/tags/">tags</a>
            </li>
          
        
          
            <li>
              <a title="my life" href="/life/">my life</a>
            </li>
          
        
          
            <li>
              <a title="about me" href="/about/">about me</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">gitbooks</a>
              <div class="navlinks-children">
                
                  <a href="https://chai2010.gitbooks.io/advanced-go-programming-book/content/">Advanced Go Programming</a>
                
                  <a href="https://jimmysong.io/kubernetes-handbook/">Kubernetes Handbook</a>
                
                  <a href="https://books.studygolang.com/gopl-zh/index.html">The Go Programming Language</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">mybooks</a>
              <div class="navlinks-children">
                
                  <a href="https://gopherzhang-1992.gitbook.io/golang-server-side/">Go后知后觉</a>
                
              </div>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Gopherzhang" href="https://driverzhang.github.io/">
            <img class="avatar-img" src="https://driverzhang.github.io/img/gopher-head.png" alt="Gopherzhang" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>this 豁然开朗！</h1>
                
                
                  <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 16, 2017
  
  
  
</span>


                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h1 id="this-豁然开朗的四种规则">this 豁然开朗的四种规则</h1>

<h3 id="调用点-call-site">调用点（call-site）</h3>

<blockquote>
<h4 id="调用点-找到一个函数是在哪里被调用的-但不总是那么简单-比如某些特定的编码模式会使-真正的-调用点变得不那么明确">调用点：“找到一个函数是在哪里被调用的”，但不总是那么简单，比如某些特定的编码模式会使 真正的 调用点变得不那么明确。</h4>

<h3 id="调用栈-call-stack">调用栈（call-stack）</h3>

<h4 id="调用栈-使我们到达当前执行位置而被调用的所有方法的堆栈">调用栈：使我们到达当前执行位置而被调用的所有方法的堆栈。</h4>

<p>我们来展示一下调用栈和调用点：</p>
</blockquote>

<p></p>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">baz</span>() {
    <span style="color:#93a1a1;font-style:italic">// 调用栈是: `baz`
</span><span style="color:#93a1a1;font-style:italic"></span>    <span style="color:#93a1a1;font-style:italic">// 我们的调用点是global scope（全局作用域）
</span><span style="color:#93a1a1;font-style:italic"></span>
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#2aa198">&#34;baz&#34;</span> );
    <span style="color:#268bd2">bar</span>(); <span style="color:#93a1a1;font-style:italic">// &lt;-- `bar`的调用点
</span><span style="color:#93a1a1;font-style:italic"></span>}

<span style="color:#859900">function</span> <span style="color:#268bd2">bar</span>() {
    <span style="color:#93a1a1;font-style:italic">// 调用栈是: `baz` -&gt; `bar`
</span><span style="color:#93a1a1;font-style:italic"></span>    <span style="color:#93a1a1;font-style:italic">// 我们的调用点位于`baz`
</span><span style="color:#93a1a1;font-style:italic"></span>
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#2aa198">&#34;bar&#34;</span> );
    <span style="color:#268bd2">foo</span>(); <span style="color:#93a1a1;font-style:italic">// &lt;-- `foo`的call-site
</span><span style="color:#93a1a1;font-style:italic"></span>}

<span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>() {
    <span style="color:#93a1a1;font-style:italic">// 调用栈是: `baz` -&gt; `bar` -&gt; `foo`
</span><span style="color:#93a1a1;font-style:italic"></span>    <span style="color:#93a1a1;font-style:italic">// 我们的调用点位于`bar`
</span><span style="color:#93a1a1;font-style:italic"></span>
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#2aa198">&#34;foo&#34;</span> );
}

<span style="color:#268bd2">baz</span>(); <span style="color:#93a1a1;font-style:italic">// &lt;-- `baz`的调用点
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<h2 id="1-this-what">1. this what?</h2>

<ol>
<li><p>this是JavaScript的关键字之一。它是 对象 自动生成的一个内部对象，只能在 对象 内部使用。随着函数使用场合的不同，this的值会发生变化。</p></li>

<li><p>this指向什么，完全取决于 什么地方以什么方式调用，而不是 创建时。（就是找到它的 调用点！）</p></li>
</ol>

<hr />

<h2 id="2-this-绑定的四种规则">2. this 绑定的四种规则</h2>

<h3 id="2-1-默认绑定-default-binding">-2.1 默认绑定（Default Binding）</h3>

<blockquote>
<h4 id="第一种规则来源于函数调用的最常见的情况-独立函数调用">第一种规则来源于函数调用的最常见的情况：独立函数调用。</h4>

<p>考虑这个代码段：</p>
</blockquote>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>() {
     <span style="color:#859900">var</span> <span style="color:#268bd2">a</span> = <span style="color:#2aa198;font-weight:bold">1</span>;
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#859900">this</span>.<span style="color:#268bd2">a</span> );
}

<span style="color:#859900">var</span> <span style="color:#268bd2">a</span> = <span style="color:#2aa198;font-weight:bold">2</span>;

<span style="color:#268bd2">foo</span>(); <span style="color:#93a1a1;font-style:italic">// 2
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<h4 id="我们看到当-foo-被调用时-this-a解析为我们的全局变量a-为什么-因为在这种情况下-对此方法调用的this实施了-默认绑定-所以使this指向了全局对象">我们看到当 foo() 被调用时，this.a解析为我们的全局变量a。为什么？因为在这种情况下，对此方法调用的this实施了 默认绑定，所以使this指向了全局对象。</h4>

<h3 id="这种就是典型的-默认绑定-我们看看foo调用的位置-光杆司令-像-这种直接使用而不带任何修饰的函数调用-就默认且只能应用-默认绑定">这种就是典型的 默认绑定，我们看看foo调用的位置，”光杆司令“，像 这种直接使用而不带任何修饰的函数调用 ，就默认且只能应用 默认绑定。</h3>

<p>那默认绑定到哪呢，一般是window上，严格模式下 是undefined。因为如果 strict mode 在这里生效，那么对于 默认绑定 来说全局对象是不合法的，所以this将被设置为undefined</p>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>() {
    <span style="color:#2aa198">&#34;use strict&#34;</span>;

    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#859900">this</span>.<span style="color:#268bd2">a</span> );
}

<span style="color:#859900">var</span> <span style="color:#268bd2">a</span> = <span style="color:#2aa198;font-weight:bold">2</span>;

<span style="color:#268bd2">foo</span>(); <span style="color:#93a1a1;font-style:italic">// TypeError: `this` is `undefined`
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<p>一个细节问题：</p>

<blockquote>
<h4 id="即便所有的this绑定规则都是完全基于调用点-如果foo-的-内容-没有在strint-mode下执行-对于-默认绑定-来说全局对象是-唯一-合法的-foo-的调用点的strict-mode状态与此无关">即便所有的this绑定规则都是完全基于调用点，如果foo()的 内容 没有在strint mode下执行，对于 默认绑定 来说全局对象是 唯一 合法的；foo()的调用点的strict mode状态与此无关。</h4>
</blockquote>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>() {
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#859900">this</span>.<span style="color:#268bd2">a</span> );
}

<span style="color:#859900">var</span> <span style="color:#268bd2">a</span> = <span style="color:#2aa198;font-weight:bold">2</span>;

(<span style="color:#859900">function</span>(){
    <span style="color:#2aa198">&#34;use strict&#34;</span>;

    <span style="color:#268bd2">foo</span>(); <span style="color:#93a1a1;font-style:italic">// 2
</span><span style="color:#93a1a1;font-style:italic"></span>})();
</code></pre></div>
<hr />

<h3 id="2-2-隐含绑定-implicit-binding">-2.2 隐含绑定（Implicit Binding）</h3>

<blockquote>
<p>调用点是否有一个环境对象（context object），也称为拥有者（owning）或容器（containing）对象，虽然这些名词可能有些误导人。</p>
</blockquote>

<p>看如下代码：</p>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>(){
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>(<span style="color:#859900">this</span>.<span style="color:#268bd2">a</span>);
}
<span style="color:#859900">var</span> <span style="color:#268bd2">obj</span> = {
    <span style="color:#268bd2">a</span> : <span style="color:#2aa198;font-weight:bold">10</span>,
    <span style="color:#268bd2">foo</span> : <span style="color:#268bd2">foo</span>
}
<span style="color:#268bd2">foo</span>();                <span style="color:#93a1a1;font-style:italic">// undefined
</span><span style="color:#93a1a1;font-style:italic"></span>
<span style="color:#268bd2">obj</span>.<span style="color:#268bd2">foo</span>();            <span style="color:#93a1a1;font-style:italic">// 10
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<p>foo();  就是上面的默认绑定，等价于打印  window.a,故输出 undefined 。</p>

<p>obj.foo(); 就是隐含绑定。</p>

<h4 id="函数foo执行的时候有了上下文对象-即-obj-这种情况下-函数里的this默认绑定为上下文对象-等价于打印obj-a-故输出10">函数foo执行的时候有了上下文对象，即 obj。这种情况下，函数里的this默认绑定为上下文对象，等价于打印obj.a,故输出10 。</h4>

<h3 id="注意-只有对象属性引用链的最后一层是影响调用点的-如下代码">注意：只有对象属性引用链的最后一层是影响调用点的，如下代码：</h3>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>() {
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#859900">this</span>.<span style="color:#268bd2">a</span> );
}

<span style="color:#859900">var</span> <span style="color:#268bd2">obj2</span> = {
    <span style="color:#268bd2">a</span>: <span style="color:#2aa198;font-weight:bold">42</span>,
    <span style="color:#268bd2">foo</span>: <span style="color:#268bd2">foo</span>
};

<span style="color:#859900">var</span> <span style="color:#268bd2">obj1</span> = {
    <span style="color:#268bd2">a</span>: <span style="color:#2aa198;font-weight:bold">2</span>,
    <span style="color:#268bd2">obj2</span>: <span style="color:#268bd2">obj2</span>
};

<span style="color:#268bd2">obj1</span>.<span style="color:#268bd2">obj2</span>.<span style="color:#268bd2">foo</span>();  <span style="color:#93a1a1;font-style:italic">// 42
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<h3 id="隐含绑定的限制-implicitly-lost">隐含绑定的限制（Implicitly Lost）</h3>

<blockquote>
<h4 id="隐性绑定中有一个致命的限制-就是上下文必须包含我们的函数-例-var-obj-foo-foo-如果上下文不包含我们的函数用隐性绑定明显是要出错的-不可能每个对象都要加这个函数-那样的话扩展-维护性太差了-我们接下来聊的就是直接-给函数强制性绑定this">隐性绑定中有一个致命的限制，就是上下文必须包含我们的函数 ，例：var obj = { foo : foo },如果上下文不包含我们的函数用隐性绑定明显是要出错的，不可能每个对象都要加这个函数 ,那样的话扩展,维护性太差了，我们接下来聊的就是直接 给函数强制性绑定this.</h4>
</blockquote>

<hr />

<h2 id="2-3-显性绑定">- 2 .3 显性绑定</h2>

<blockquote>
<p>call、
apply 、
bind</p>

<p>函数 call 和 apply，它们的作用都是改变函数的this指向，第一个参数都是 设置this对象。</p>
</blockquote>

<h3 id="两个函数的区别">两个函数的区别：</h3>

<ol>
<li>call从第二个参数开始所有的参数都是 原函数的参数。</li>
<li>apply只接受两个参数，且第二个参数必须是数组，这个数组代表原函数的参数列表。
例如：</li>
</ol>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>(<span style="color:#268bd2">a</span>,<span style="color:#268bd2">b</span>){
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>(<span style="color:#268bd2">a</span>+<span style="color:#268bd2">b</span>);
}
<span style="color:#268bd2">foo</span>.<span style="color:#268bd2">call</span>(<span style="color:#859900;font-weight:bold">null</span>,<span style="color:#2aa198">&#39;海洋&#39;</span>,<span style="color:#2aa198">&#39;饼干&#39;</span>);        <span style="color:#93a1a1;font-style:italic">// 海洋饼干  这里this指向不重要就写null了
</span><span style="color:#93a1a1;font-style:italic"></span><span style="color:#268bd2">foo</span>.<span style="color:#268bd2">apply</span>(<span style="color:#859900;font-weight:bold">null</span>, [<span style="color:#2aa198">&#39;海洋&#39;</span>,<span style="color:#2aa198">&#39;饼干&#39;</span>] );     <span style="color:#93a1a1;font-style:italic">// 海洋饼干
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<p>除了 call，apply函数以外，还有一个改变this的函数 bind ，它和call,apply都不同。</p>

<h3 id="bind-只有一个函数-且不会立刻执行-只是将一个值绑定到函数的this上-并将绑定好的函数返回-例">bind 只有一个函数，且不会立刻执行，只是将一个值绑定到函数的this上,并将绑定好的函数返回。例:</h3>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>(){
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>(<span style="color:#859900">this</span>.<span style="color:#268bd2">a</span>);
}
<span style="color:#859900">var</span> <span style="color:#268bd2">obj</span> = { <span style="color:#268bd2">a</span> : <span style="color:#2aa198;font-weight:bold">10</span> };

<span style="color:#268bd2">foo</span> = <span style="color:#268bd2">foo</span>.<span style="color:#268bd2">bind</span>(<span style="color:#268bd2">obj</span>);
<span style="color:#268bd2">foo</span>();                    <span style="color:#93a1a1;font-style:italic">// 10
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<h3 id="开始我们的显性绑定">开始我们的显性绑定</h3>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>(){
    <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>(<span style="color:#859900">this</span>.<span style="color:#268bd2">a</span>);
}
<span style="color:#859900">var</span> <span style="color:#268bd2">obj</span> = {
    <span style="color:#268bd2">a</span> : <span style="color:#2aa198;font-weight:bold">10</span>            <span style="color:#93a1a1;font-style:italic">//去掉里面的foo
</span><span style="color:#93a1a1;font-style:italic"></span>}
<span style="color:#268bd2">foo</span>.<span style="color:#268bd2">call</span>(<span style="color:#268bd2">obj</span>);        <span style="color:#93a1a1;font-style:italic">// 10
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<p>我们将隐性绑定例子中的 上下文对象 里的函数去掉了，显然现在不能用 上下文.函数 这种形式来调用函数，大家看代码里的显性绑定代码foo.call(obj)，看起来很怪，和我们之前所了解的函数调用不一样。</p>

<p>其实call 是 foo 上的一个函数,在改变this指向的同时执行这个函数。</p>

<hr />

<h2 id="2-4-new-绑定">-2.4 new 绑定</h2>

<blockquote>
<p>js中的只要用new修饰的 函数就是&rsquo;构造函数&rsquo;，准确来说是 函数的构造调用，因为在js中并不存在所谓的&rsquo;构造函数&rsquo;。</p>
</blockquote>

<p>用 new 做到函数的构造调用后，js帮我们做了什么工作呢:
1. 创建一个新对象。
2. 把这个新对象的<strong>proto</strong>属性指向 原函数的prototype属性。或者说是将构造函数的作用域给这个新对象。(即继承原函数的原型，因此 this 就指向了这个新对象)；
3. 将这个新对象绑定到 此函数的this上 。（执行构造函数中的代码）；
4. 返回新对象；</p>

<p>第三条就是我们下面要聊的new绑定。</p>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">function</span> <span style="color:#268bd2">foo</span>(<span style="color:#268bd2">a</span>) {
    <span style="color:#859900">this</span>.<span style="color:#268bd2">a</span> = <span style="color:#268bd2">a</span>;
}

<span style="color:#859900">var</span> <span style="color:#268bd2">bar</span> = <span style="color:#859900">new</span> <span style="color:#268bd2">foo</span>( <span style="color:#2aa198;font-weight:bold">2</span> );
<span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>( <span style="color:#268bd2">bar</span>.<span style="color:#268bd2">a</span> ); <span style="color:#93a1a1;font-style:italic">// 2
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<p>通过在前面使用new来调用foo(..)，我们构建了一个新的对象并这个新对象作为foo(..)调用的this。</p>

<h4 id="new是函数调用可以绑定this的最后一种方式-我们称之为-new绑定-new-binding">new是函数调用可以绑定this的最后一种方式，我们称之为 new绑定（new binding）。</h4>

<hr />

<h2 id="2-5-this绑定优先级">- 2 .5 this绑定优先级</h2>

<h3 id="new-绑定-显示绑定-隐式绑定-默认绑定">new 绑定 &gt; 显示绑定 &gt; 隐式绑定 &gt; 默认绑定</h3>

<hr />

<h2 id="3-总结">-3. 总结</h2>

<h3 id="1-如果函数被new-修饰">1. 如果函数被new 修饰</h3>

<p>this绑定的是新创建的对象，例:var bar = new foo(); 函数 foo 中的 this 就是一个叫foo的新创建的对象 , 然后将这个对象赋给bar , 这样的绑定方式叫 new绑定 .</p>

<h3 id="2-如果函数是使用call-apply-bind来调用的">2. 如果函数是使用call,apply,bind来调用的</h3>

<p>this绑定的是 call,apply,bind 的第一个参数.例: foo.call(obj); , foo 中的 this 就是 obj , 这样的绑定方式叫 显性绑定 .</p>

<h3 id="3-如果函数是在某个-上下文对象-容器-下被调用">3. 如果函数是在某个 上下文对象（容器） 下被调用</h3>

<p>this绑定的是那个上下文对象，例 : var obj = { foo : foo }; obj.foo(); foo 中的 this 就是 obj . 这样的绑定方式叫 隐性绑定 .</p>

<h3 id="4-如果都不是-即使用默认绑定">4. 如果都不是，即使用默认绑定</h3>

<p>例:function foo(){&hellip;} foo() ,foo 中的 this 就是 window.(严格模式下默认绑定到undefined).
   这样的绑定方式叫 默认绑定 .</p>

<hr />

<h2 id="例题如下">例题如下：</h2>
<div class="highlight"><pre style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#859900">var</span> <span style="color:#268bd2">x</span> = <span style="color:#2aa198;font-weight:bold">10</span>;
<span style="color:#859900">var</span> <span style="color:#268bd2">obj</span> = {
    <span style="color:#268bd2">x</span>: <span style="color:#2aa198;font-weight:bold">20</span>,
    <span style="color:#268bd2">f</span>: <span style="color:#859900">function</span>(){ <span style="color:#268bd2">console</span>.<span style="color:#268bd2">log</span>(<span style="color:#859900">this</span>.<span style="color:#268bd2">x</span>); }
};
<span style="color:#859900">var</span> <span style="color:#268bd2">bar</span> = <span style="color:#268bd2">obj</span>.<span style="color:#268bd2">f</span>;
<span style="color:#859900">var</span> <span style="color:#268bd2">obj2</span> = {
    <span style="color:#268bd2">x</span>: <span style="color:#2aa198;font-weight:bold">30</span>,
    <span style="color:#268bd2">f</span>: <span style="color:#268bd2">obj</span>.<span style="color:#268bd2">f</span>
}
<span style="color:#268bd2">obj</span>.<span style="color:#268bd2">f</span>(); <span style="color:#93a1a1;font-style:italic">// 隐含绑定
</span><span style="color:#93a1a1;font-style:italic"></span><span style="color:#268bd2">bar</span>();  <span style="color:#93a1a1;font-style:italic">// 默认绑定
</span><span style="color:#93a1a1;font-style:italic"></span><span style="color:#268bd2">obj2</span>.<span style="color:#268bd2">f</span>(); <span style="color:#93a1a1;font-style:italic">// 隐含绑定
</span><span style="color:#93a1a1;font-style:italic"></span></code></pre></div>
<p>答案：20 10 30。</p>

        
          <div class="blog-tags">
            
              <a href="https://driverzhang.github.io//tags/js/">js</a>&nbsp;
            
              <a href="https://driverzhang.github.io//tags/%E5%9F%BA%E7%A1%80/">基础</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <ul class="list-inline footer-links">
                


<li>
    <a href="//twitter.com/share?url=https%3a%2f%2fdriverzhang.github.io%2fpost%2fthis-%25E8%25B1%2581%25E7%2584%25B6%25E5%25BC%2580%25E6%259C%2597%2f&amp;text=this%20%e8%b1%81%e7%84%b6%e5%bc%80%e6%9c%97%ef%bc%81&amp;via="
       target="_blank" alt="" title="Share on Twitter">
        <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
    </a>
</li>


<li>
    <a href="//plus.google.com/share?url=https%3a%2f%2fdriverzhang.github.io%2fpost%2fthis-%25E8%25B1%2581%25E7%2584%25B6%25E5%25BC%2580%25E6%259C%2597%2f" target="_blank" title="Share on Google Plus">
         <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
              </span>
    </a>
</li>


<li>
    <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdriverzhang.github.io%2fpost%2fthis-%25E8%25B1%2581%25E7%2584%25B6%25E5%25BC%2580%25E6%259C%2597%2f" target="_blank" title="Share on Facebook">
        <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
              </span>
    </a>
</li>


<li>
    <a href="//reddit.com/submit?url=https%3a%2f%2fdriverzhang.github.io%2fpost%2fthis-%25E8%25B1%2581%25E7%2584%25B6%25E5%25BC%2580%25E6%259C%2597%2f&amp;title=this%20%e8%b1%81%e7%84%b6%e5%bc%80%e6%9c%97%ef%bc%81" target="_blank" title="Share on Reddit">
         <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-reddit fa-stack-1x fa-inverse"></i>
              </span>
    </a>
</li>


<li>
    <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fdriverzhang.github.io%2fpost%2fthis-%25E8%25B1%2581%25E7%2584%25B6%25E5%25BC%2580%25E6%259C%2597%2f&amp;title=this%20%e8%b1%81%e7%84%b6%e5%bc%80%e6%9c%97%ef%bc%81" target="_blank"
       title="Share on LinkedIn">
         <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
    </a>
</li>


<li>
    <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fdriverzhang.github.io%2fpost%2fthis-%25E8%25B1%2581%25E7%2584%25B6%25E5%25BC%2580%25E6%259C%2597%2f&amp;title=this%20%e8%b1%81%e7%84%b6%e5%bc%80%e6%9c%97%ef%bc%81" target="_blank"
       title="Share on StumbleUpon">
        <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-stumbleupon fa-stack-1x fa-inverse"></i>
              </span>
    </a>
</li>


<li>
    <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fdriverzhang.github.io%2fpost%2fthis-%25E8%25B1%2581%25E7%2584%25B6%25E5%25BC%2580%25E6%259C%2597%2f&amp;description=this%20%e8%b1%81%e7%84%b6%e5%bc%80%e6%9c%97%ef%bc%81" target="_blank"
       title="Share on Pinterest">
         <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-pinterest fa-stack-1x fa-inverse"></i>
              </span>
    </a>
</li>

              </ul>
            </section>
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://driverzhang.github.io/post/%E5%A4%B4%E5%83%8F%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0filereader/" data-toggle="tooltip" data-placement="top" title="FileReader图片上传到服务器">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://driverzhang.github.io/post/getquerystringargs/" data-toggle="tooltip" data-placement="top" title="getQueryStringArgs">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://www.facebook.com/xiaoxin.zhang" title="Facebook">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/driverzhang" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            
            <a href="https://driverzhang.github.io/index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Gopherzhang
            
          

          &nbsp;&bull;&nbsp;
          2022

          
            &nbsp;&bull;&nbsp;
            <a href="https://driverzhang.github.io/">Gopherzhang</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.48</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://driverzhang.github.io/js/main.js"></script>
<script src="https://driverzhang.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="https://driverzhang.github.io/js/load-photoswipe.js"></script>






  </body>
</html>

